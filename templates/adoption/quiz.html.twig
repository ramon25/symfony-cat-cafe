{% extends 'base.html.twig' %}

{% block title %}Compatibility Quiz - {{ cat.name }} | Whiskers & Wonders{% endblock %}

{% block body %}
<div class="max-w-2xl mx-auto">
    <!-- Back Button -->
    <a href="{{ path('app_cat_show', {id: cat.id}) }}" class="inline-flex items-center text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 mb-6">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        Back to {{ cat.name }}
    </a>

    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
        <!-- Header -->
        <div class="bg-gradient-to-r from-purple-500 to-pink-500 p-6 text-center">
            <span class="text-6xl mb-4 block">{{ cat.moodEmoji }}</span>
            <h1 class="text-3xl font-bold text-white">Compatibility Quiz</h1>
            <p class="text-purple-100 mt-2">Let's see how well you and {{ cat.name }} match!</p>
        </div>

        {% if existingScore is not null %}
        <div class="bg-green-100 dark:bg-green-900/50 border-b border-green-200 dark:border-green-800 p-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <span class="text-2xl mr-3">{{ cat.compatibilityEmoji }}</span>
                    <div>
                        <p class="font-bold text-green-800 dark:text-green-200">You've already taken this quiz!</p>
                        <p class="text-sm text-green-600 dark:text-green-300">Your score: {{ existingScore }}% - {{ cat.compatibilityLabel }}</p>
                    </div>
                </div>
                <a href="{{ path('app_cat_quiz_result', {id: cat.id}) }}" class="text-green-600 hover:text-green-700 dark:text-green-400 font-medium">
                    View Results
                </a>
            </div>
        </div>
        {% endif %}

        <form action="{{ path('app_cat_quiz_submit', {id: cat.id}) }}" method="POST" class="p-6 space-y-8">
            <div class="text-center mb-8">
                <p class="text-gray-600 dark:text-gray-300">Answer these fun questions to discover your compatibility with {{ cat.name }}!</p>
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">There are no wrong answers - just be yourself!</p>
            </div>

            {% for question in questions %}
            <div class="border dark:border-gray-700 rounded-xl p-6 bg-gray-50 dark:bg-gray-700/50">
                <div class="flex items-center mb-4">
                    <span class="text-3xl mr-3">{{ question.emoji }}</span>
                    <h3 class="text-lg font-bold text-gray-800 dark:text-white">{{ question.question }}</h3>
                </div>

                <div class="space-y-3">
                    {% for option in question.options %}
                    <label class="flex items-center p-4 bg-white dark:bg-gray-800 rounded-lg border-2 border-transparent hover:border-purple-300 dark:hover:border-purple-600 cursor-pointer transition-all group">
                        <input type="radio" name="{{ question.id }}" value="{{ option.value }}" required
                               class="w-5 h-5 text-purple-600 focus:ring-purple-500 dark:focus:ring-purple-400">
                        <span class="ml-3 text-gray-700 dark:text-gray-200 group-hover:text-purple-600 dark:group-hover:text-purple-400">{{ option.label }}</span>
                    </label>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}

            <div class="pt-6 border-t dark:border-gray-700">
                <button type="submit" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-4 px-6 rounded-xl transition-all text-lg flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl">
                    <span class="text-2xl">{{ cat.moodEmoji }}</span>
                    <span>See My Compatibility!</span>
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
